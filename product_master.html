<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

  <title>Hello, world!</title>
  <link rel="stylesheet" href="header.css">
</head>
<body>
    <header class="header">
        <div class="menu-icon" onclick="toggleMenu()">☰</div>
        <div class="user-menu">
            <div class="user-menu">
                <div class="user-icon">&#128100;</div>
                <span id="usernamePlaceholder"></span>
                <div class="logout"><a href="#" id="logoutLink">Logout</a></div>
            </div>
        </div>
        <div class="menu-options" id="menuOptions">
            <a href="#">Home</a>
            <a href="#">About</a>
            <a href="product_master.html">Product Master</a>
            <a href="#">Services</a>
            <a href="#">Blog</a>
            <a href="#">Contact</a>
            <!-- Add more options as needed -->
        </div>
    </header>
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <script src="header.js"></script>
    <script>
        // Call the initializeHeader function when the document is ready
        $(document).ready(function () {
            initializeHeader();
        });


        // header.js

function toggleMenu() {
    var menuOptions = document.getElementById('menuOptions');
    var menuIcon = document.querySelector('.menu-icon');

    if (menuOptions.style.display === 'block') {
        menuOptions.style.display = 'none';
        menuIcon.innerHTML = '☰';
    } else {
        menuOptions.style.display = 'block';
        menuIcon.innerHTML = '✖';
    }
}

function initializeHeader() {
  var storedUsername = localStorage.getItem('username');
  var usernameInput = document.getElementById('username');
  
  if (storedUsername) {
      document.getElementById('usernamePlaceholder').textContent = storedUsername;
      usernameInput.value = storedUsername; // Set the value of the hidden input field
  } else {
      document.getElementById('usernamePlaceholder').textContent = 'Guest';
      usernameInput.value = 'Guest'; // Set the value of the hidden input field
  }

    $('#logoutLink').on('click', function (e) {
        e.preventDefault();

        // Ask for confirmation
        var confirmLogout = confirm("Are you sure you want to logout?");
        if (!confirmLogout) {
            return;
        }

        localStorage.removeItem('username');

        $.ajax({
            type: 'GET',
            url: 'logout_process.php',
            success: function (response) {
                if (response === 'success') {
                    window.location.href = 'login.html';
                } else {
                    alert('Logout failed. Please try again.');
                }
            },
            error: function () {
                alert('Error occurred during logout process');
            }
        });
    });
}

    </script>




  <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container-fluid">
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav">
          <li class="nav-item">
            <button type="button" class="btn btn-primary nav-link active" data-bs-toggle="modal" data-bs-target="#addProductModal">
              Add New
            </button>
          </li>
          <li class="nav-item">
            <a class="nav-link active" href="#" id="refreshButton">Refresh</a>
          </li>
          <li class="nav-item">
            <div class="form-inline">
              <div class="input-group">
                <input class="form-control" type="search" id="searchInput" placeholder="Search Employee ID" aria-label="Search">
                <button class="btn btn-outline-success" id="searchButton">Search</button>
              </div>
            </div>
          </li>
        </ul>
      </div>
    </div>
  </nav>
  <div class="container my-4">
    <table class="table" id="productTable">
      <!-- Table content will be populated dynamically using JavaScript -->
    </table>
  </div>
    
 <!-- Add New Product Modal -->
<div class="modal fade" id="addProductModal" tabindex="-1" aria-labelledby="addProductModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="addProductModalLabel">Add New Product</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form method="POST" action="add_product.php" onsubmit="return confirmAddProduct();">
          <div class="mb-3">
            <label for="productCode" class="form-label">Product Code</label>
            <input type="text" class="form-control" id="productCode" name="productCode" required>
          </div>
          <div class="mb-3">
            <label for="productName" class="form-label">Product Name</label>
            <input type="text" class="form-control" id="productName" name="productName" required>
          </div>
          <div class="mb-3">
            <label for="UOM" class="form-label">Unit of Measure</label>
            <select class="form-select" id="UOM" name="UOM" required>
              <option value="" selected disabled>Select UOM</option>
              <option value="kg">Kilogram (kg)</option>
              <option value="g">Gram (g)</option>
              <option value="lb">Pound (lb)</option>
              <option value="oz">Ounce (oz)</option>
              <option value="ltr">Liter (ltr)</option>
              <option value="ml">Milliliter (ml)</option>
              <option value="m">Meter (m)</option>
              <option value="cm">Centimeter (cm)</option>
              <option value="mm">Millimeter (mm)</option>
              <!-- Add more options as needed -->
            </select>
          </div>
          <div class="mb-3">
            <label for="stock" class="form-label">Stock</label>
            <input type="number" class="form-control" id="stock" name="stock" required>
          </div>
          <div class="mb-3">
            <label for="sellingPrice" class="form-label">Selling Price</label>
            <input type="number" class="form-control" id="sellingPrice" name="sellingPrice" required>
          </div>
          <div class="mb-3">
            <label for="offerPrice" class="form-label">Offer Price</label>
            <input type="number" class="form-control" id="offerPrice" name="offerPrice" required>
          </div>
          <div class="mb-3">
            <label for="productImage" class="form-label">Product Image URL</label>
            <input type="text" class="form-control" id="productImage" name="productImage" required>
          </div>

          <div class="modal-footer">
            <button type="submit" class="btn btn-primary">Add Product</button>
          </div>
          <!-- Add this hidden input field to your form -->
          <input type="hidden" id="username" name="username" value="">

        </form>
      </div>
    </div>
  </div>
</div>
<script>
  function confirmAddProduct() {
    return confirm("Are you sure you want to add this product?");
  }

</script>

<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js" integrity="sha384-rddjVBzVT4HCAqGXL1DYlSe12aAzLu+eEzNSiCyr4UvMoU6bsKQmThAwAHLgjz9w" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-rA5KuL8Hc7Ow5s/g/Ty8t35p9tPdRiYziZmnn9Z18ekyiWsKjNlCFywXB9IHtDR5" crossorigin="anonymous"></script>

<!-- Edit Employee Modal -->
<div class="modal fade" id="editEmployeeModal" tabindex="-1" aria-labelledby="editEmployeeModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="editEmployeeModalLabel">Edit Employee Details</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form method="POST" action="edit_employee.php" onsubmit="return confirmEdit();">
          <input type="hidden" id="editEmployeeId" name="employeeId">
          <div class="mb-3">
            <label for="editEmployeeName" class="form-label">Employee Name</label>
            <input type="text" class="form-control" id="editEmployeeName" name="employeeName" required>
          </div>
          <div class="mb-3">
            <label for="editDesignation" class="form-label">Designation</label>
            <input type="text" class="form-control" id="editDesignation" name="designation" required>
          </div>
          <div class="mb-3">
            <label for="editSalary" class="form-label">Salary</label>
            <input type="number" class="form-control" id="editSalary" name="salary" required>
          </div>
          <div class="modal-footer">
            <button type="submit" class="btn btn-primary">Save Changes</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<script>
  function confirmEdit() {
    return confirm("Are you sure you want to save these changes?");
  }
</script>



   <!-- Bootstrap Bundle with Popper -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script>
    // JavaScript to perform dynamic operations
    $(document).ready(function () {
      // Function to refresh the table
      function refreshProductTable() {
      $.ajax({
        url: 'get_products.php',
        type: 'GET',
        success: function (data) {
          $('#productTable').html(data);
        }
      });
    }

    // Event listener for the refresh button
    $(document).ready(function () {
      refreshProductTable();
    });

      // Event listener for the search button
      $('#searchButton').click(function () {
        var searchId = $('#searchInput').val();
        $.ajax({
          url: 'get_products.php',
          type: 'GET',
          data: { search: searchId },
          success: function (data) {
            $('#employeeTable').html(data);
          }
        });
      });

      // Event listener for the edit button
      $(document).on("click", ".edit-employee", function () {
        var employeeId = $(this).data("id");
        var employeeName = $(this).data("name");
        var designation = $(this).data("designation");
        var salary = $(this).data("salary");

        populateEditModal(employeeId, employeeName, designation, salary);
      });

      // Function to populate the edit modal with selected employee details
      function populateEditModal(employeeId, employeeName, designation, salary) {
        $("#editEmployeeId").val(employeeId);
        $("#editEmployeeName").val(employeeName);
        $("#editDesignation").val(designation);
        $("#editSalary").val(salary);
      }

      // Initial table load
      refreshTable();
    });
  </script>
</body>
</html>